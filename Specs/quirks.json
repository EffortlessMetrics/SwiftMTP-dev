{
  "$schema": "./quirks.schema.json",
  "schemaVersion": "1.0.0",
  "version": 1,
  "entries": [
    {
      "id": "xiaomi-mi-note-2-ff10",
      "match": {
        "vid": "0x2717",
        "pid": "0xff10",
        "deviceInfoRegex": ".*Mi Note 2.*",
        "iface": {
          "class": "0x06",
          "subclass": "0x01",
          "protocol": "0x01"
        },
        "endpoints": {
          "in": "0x81",
          "out": "0x01",
          "evt": "0x82"
        }
      },
      "tuning": {
        "maxChunkBytes": 2097152,
        "handshakeTimeoutMs": 6000,
        "ioTimeoutMs": 15000,
        "inactivityTimeoutMs": 8000,
        "overallDeadlineMs": 120000,
        "stabilizeMs": 400,
        "eventPumpDelayMs": 0
      },
      "hooks": [
        { "phase": "postOpenSession", "delayMs": 400 },
        { "phase": "beforeGetStorageIDs", "busyBackoff": { "retries": 3, "baseMs": 200, "jitterPct": 0.2 } }
      ],
      "ops": {
        "supportsGetPartialObject64": true,
        "supportsSendPartialObject": true,
        "preferGetObjectPropList": false,
        "disableWriteResume": false
      },
      "confidence": "high",
      "status": "stable",
      "notes": [
        "Requires 250-500 ms stabilization after OpenSession.",
        "Prefer direct USB port; keep screen unlocked.",
        "Back off on DEVICE_BUSY for early storage ops."
      ],
      "provenance": {
        "author": "Steven Zimmerman",
        "date": "2025-01-09",
        "commit": "<current-commit>",
        "artifacts": {
          "probe": "Docs/benchmarks/probes/mi-note2-probe.txt",
          "usbDump": "Docs/benchmarks/probes/mi-note2-usb-dump.txt",
          "bench100M": "Docs/benchmarks/csv/mi-note2-100m.csv",
          "bench1G": "Docs/benchmarks/csv/mi-note2-1g.csv",
          "mirrorLog": "Docs/benchmarks/logs/mi-note2-mirror.log"
        }
      }
    },
    {
      "id": "xiaomi-mi-note-2-ff40",
      "match": {
        "vid": "0x2717",
        "pid": "0xff40",
        "deviceInfoRegex": ".*Mi Note 2.*",
        "iface": {
          "class": "0x06",
          "subclass": "0x01",
          "protocol": "0x01"
        },
        "endpoints": {
          "in": "0x81",
          "out": "0x01",
          "evt": "0x82"
        }
      },
      "tuning": {
        "maxChunkBytes": 2097152,
        "handshakeTimeoutMs": 6000,
        "ioTimeoutMs": 15000,
        "inactivityTimeoutMs": 8000,
        "overallDeadlineMs": 120000,
        "stabilizeMs": 400,
        "eventPumpDelayMs": 0
      },
      "ops": {
        "supportsGetPartialObject64": true,
        "supportsSendPartialObject": true,
        "preferGetObjectPropList": false,
        "disableWriteResume": false
      },
      "notes": [
        "Same tuning as ff10 variant.",
        "Requires 250-500 ms stabilization after OpenSession.",
        "Prefer direct USB port; keep screen unlocked."
      ],
      "provenance": {
        "author": "Steven Zimmerman",
        "date": "2025-01-09",
        "commit": "<current-commit>",
        "artifacts": {
          "probe": "Docs/benchmarks/probes/mi-note2-probe.txt",
          "usbDump": "Docs/benchmarks/probes/mi-note2-usb-dump.txt",
          "bench100M": "Docs/benchmarks/csv/mi-note2-100m.csv",
          "bench1G": "Docs/benchmarks/csv/mi-note2-1g.csv",
          "mirrorLog": "Docs/benchmarks/logs/mi-note2-mirror.log"
        }
      },
      "status": "stable"
    },
    {
      "id": "oneplus-3t-f003",
      "match": {
        "vid": "0x2a70",
        "pid": "0xf003",
        "iface": {
          "class": "0x06",
          "subclass": "0x01",
          "protocol": "0x01"
        }
      },
      "tuning": {
        "maxChunkBytes": 1048576,
        "handshakeTimeoutMs": 15000,
        "ioTimeoutMs": 30000,
        "inactivityTimeoutMs": 10000,
        "overallDeadlineMs": 120000,
        "stabilizeMs": 500,
        "resetOnOpen": true
      },
      "hooks": [
        { "phase": "postOpenSession", "delayMs": 500 }
      ],
      "confidence": "medium",
      "status": "experimental",
      "notes": [
        "OnePlus 3T (2a70:f003) requires resetOnOpen to recover from previous session hangs.",
        "PTP Device Reset (0x66) clears stale kernel sessions before OpenSession."
      ],
      "provenance": {
        "author": "Gemini CLI",
        "date": "2026-02-06"
      }
    },
    {
      "id": "google-pixel-7-4ee1",
      "match": {
        "vid": "0x18d1",
        "pid": "0x4ee1",
        "iface": {
          "class": "0x06",
          "subclass": "0x01",
          "protocol": "0x01"
        }
      },
      "tuning": {
        "maxChunkBytes": 2097152,
        "handshakeTimeoutMs": 20000,
        "ioTimeoutMs": 30000,
        "inactivityTimeoutMs": 10000,
        "overallDeadlineMs": 180000,
        "stabilizeMs": 3000,
        "resetOnOpen": false
      },
      "confidence": "medium",
      "status": "stable",
      "notes": [
        "libmtp-aligned claim (set_configuration + set_alt_setting) reinitializes pipes without USB reset.",
        "Fallback USB reset uses stabilizeMs=3000 as poll budget for waitForMTPReady.",
        "Bulk transfer failures often caused by Chrome/WebUSB holding the device â€” quit Chromium apps and replug."
      ],
      "provenance": {
        "author": "Steven Zimmerman",
        "date": "2026-02-07"
      }
    }
  ]
}
