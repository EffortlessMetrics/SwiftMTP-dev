{
  "$schema": "./quirks.schema.json",
  "schemaVersion": "1.0.0",
  "version": 1,
  "entries": [
    {
      "id": "xiaomi-mi-note-2-ff10",
      "match": {
        "vid": "0x2717",
        "pid": "0xff10",
        "deviceInfoRegex": ".*Mi Note 2.*",
        "iface": {
          "class": "0x06",
          "subclass": "0x01",
          "protocol": "0x01"
        },
        "endpoints": {
          "in": "0x81",
          "out": "0x01",
          "evt": "0x82"
        }
      },
      "tuning": {
        "maxChunkBytes": 2097152,
        "handshakeTimeoutMs": 6000,
        "ioTimeoutMs": 15000,
        "inactivityTimeoutMs": 8000,
        "overallDeadlineMs": 120000,
        "stabilizeMs": 400,
        "eventPumpDelayMs": 0
      },
      "hooks": [
        { "phase": "postOpenSession", "delayMs": 400 },
        { "phase": "beforeGetStorageIDs", "busyBackoff": { "retries": 3, "baseMs": 200, "jitterPct": 0.2 } }
      ],
      "ops": {
        "supportsGetPartialObject64": true,
        "supportsSendPartialObject": true,
        "preferGetObjectPropList": false,
        "disableWriteResume": false
      },
      "confidence": "high",
      "status": "stable",
      "notes": [
        "Requires 250-500 ms stabilization after OpenSession.",
        "Prefer direct USB port; keep screen unlocked.",
        "Back off on DEVICE_BUSY for early storage ops."
      ],
      "provenance": {
        "author": "Steven Zimmerman",
        "date": "2025-01-09",
        "commit": "<current-commit>",
        "artifacts": {
          "probe": "Docs/benchmarks/probes/mi-note2-probe.txt",
          "usbDump": "Docs/benchmarks/probes/mi-note2-usb-dump.txt",
          "bench100M": "Docs/benchmarks/csv/mi-note2-100m.csv",
          "bench1G": "Docs/benchmarks/csv/mi-note2-1g.csv",
          "mirrorLog": "Docs/benchmarks/logs/mi-note2-mirror.log"
        }
      }
    },
    {
      "id": "xiaomi-mi-note-2-ff40",
      "match": {
        "vid": "0x2717",
        "pid": "0xff40",
        "deviceInfoRegex": ".*Mi Note 2.*",
        "iface": {
          "class": "0xff"
        },
        "endpoints": {
          "in": "0x81",
          "out": "0x01",
          "evt": "0x82"
        }
      },
      "tuning": {
        "maxChunkBytes": 2097152,
        "handshakeTimeoutMs": 6000,
        "ioTimeoutMs": 15000,
        "inactivityTimeoutMs": 8000,
        "overallDeadlineMs": 120000,
        "stabilizeMs": 400,
        "resetOnOpen": true,
        "requiresKernelDetach": true,
        "eventPumpDelayMs": 0
      },
      "ops": {
        "supportsGetPartialObject64": true,
        "supportsSendPartialObject": true,
        "preferGetObjectPropList": false,
        "disableWriteResume": false
      },
      "notes": [
        "Same tuning as ff10 variant with vendor-specific (0xff) MTP interface matching.",
        "Enabled resetOnOpen and requiresKernelDetach for better claim reliability on macOS.",
        "Requires 250-500 ms stabilization after OpenSession.",
        "Prefer direct USB port; keep screen unlocked."
      ],
      "provenance": {
        "author": "Steven Zimmerman",
        "date": "2025-01-09",
        "commit": "<current-commit>",
        "artifacts": {
          "probe": "Docs/benchmarks/probes/mi-note2-probe.txt",
          "usbDump": "Docs/benchmarks/probes/mi-note2-usb-dump.txt",
          "bench100M": "Docs/benchmarks/csv/mi-note2-100m.csv",
          "bench1G": "Docs/benchmarks/csv/mi-note2-1g.csv",
          "mirrorLog": "Docs/benchmarks/logs/mi-note2-mirror.log"
        }
      },
      "status": "stable"
    },
    {
      "id": "samsung-android-6860",
      "match": {
        "vid": "0x04e8",
        "pid": "0x6860",
        "deviceInfoRegex": ".*SAMSUNG.*",
        "iface": {
          "class": "0xff"
        },
        "endpoints": {
          "in": "0x81",
          "out": "0x01",
          "evt": "0x82"
        }
      },
      "tuning": {
        "maxChunkBytes": 1048576,
        "handshakeTimeoutMs": 8000,
        "ioTimeoutMs": 12000,
        "inactivityTimeoutMs": 10000,
        "overallDeadlineMs": 120000,
        "stabilizeMs": 300,
        "resetOnOpen": true,
        "requiresKernelDetach": true
      },
      "ops": {
        "supportsGetPartialObject64": true,
        "supportsSendPartialObject": false,
        "preferGetObjectPropList": true,
        "disableWriteResume": true
      },
      "confidence": "medium",
      "status": "experimental",
      "notes": [
        "Vendor-specific interface class (0xff) discovered by shared MTP heuristic.",
        "Enabled resetOnOpen and requiresKernelDetach for better claim reliability on macOS.",
        "Read validation is reliable; write smoke remains best-effort for this class of Samsung devices.",
        "Use conservative chunking and timeout values."
      ],
      "provenance": {
        "author": "Steven Zimmerman",
        "date": "2026-02-09"
      }
    },
    {
      "id": "oneplus-3t-f003",
      "match": {
        "vid": "0x2a70",
        "pid": "0xf003",
        "deviceInfoRegex": ".*ONEPLUS A3010.*",
        "iface": {
          "class": "0x06",
          "subclass": "0x01",
          "protocol": "0x01"
        },
        "endpoints": {
          "in": "0x81",
          "out": "0x01",
          "evt": "0x82"
        }
      },
      "tuning": {
        "maxChunkBytes": 1048576,
        "handshakeTimeoutMs": 6000,
        "ioTimeoutMs": 8000,
        "inactivityTimeoutMs": 10000,
        "overallDeadlineMs": 120000,
        "stabilizeMs": 200,
        "resetOnOpen": false,
        "skipPTPReset": true,
        "eventPumpDelayMs": 0
      },
      "hooks": [
        { "phase": "postOpenSession", "delayMs": 200 }
      ],
      "ops": {
        "supportsGetPartialObject64": true,
        "supportsSendPartialObject": true,
        "preferGetObjectPropList": true,
        "supportsEvents": true,
        "disableWriteResume": false
      },
      "confidence": "high",
      "status": "stable",
      "notes": [
        "OnePlus 3T (ONEPLUS A3010) probes in ~115 ms; no resetOnOpen needed with new claim sequence.",
        "PTP Device Reset (0x66) NOT supported (rc=-9, LIBUSB_ERROR_PIPE); skipPTPReset=true.",
        "Session opens instantly (0 ms), no retry needed.",
        "SendObject returns 0x201D (InvalidParameter) when writing to storage root; use a subfolder as parent.",
        "Second USB interface is Mass Storage (class=0x08); ignored by MTP transport.",
        "Fallback strategies: enum=propList5, read=partial64, write=partial."
      ],
      "provenance": {
        "author": "Steven Zimmerman",
        "date": "2026-02-07",
        "artifacts": {
          "probe": "Docs/benchmarks/probes/oneplus3t-probe.txt",
          "usbDump": "Docs/benchmarks/probes/oneplus3t-usb-dump.txt"
        }
      }
    },
    {
      "id": "google-pixel-7-4ee1",
      "match": {
        "vid": "0x18d1",
        "pid": "0x4ee1",
        "iface": {
          "class": "0x06",
          "subclass": "0x01",
          "protocol": "0x01"
        },
        "endpoints": {
          "in": "0x81",
          "out": "0x01",
          "evt": "0x82"
        }
      },
      "tuning": {
        "maxChunkBytes": 2097152,
        "handshakeTimeoutMs": 20000,
        "ioTimeoutMs": 30000,
        "inactivityTimeoutMs": 10000,
        "overallDeadlineMs": 180000,
        "stabilizeMs": 3000,
        "resetOnOpen": false
      },
      "confidence": "medium",
      "status": "stable",
      "notes": [
        "libmtp-aligned claim (set_configuration + set_alt_setting) reinitializes pipes without USB reset.",
        "Fallback USB reset uses stabilizeMs=3000 as poll budget for waitForMTPReady.",
        "Bulk transfer failures often caused by Chrome/WebUSB holding the device â€” quit Chromium apps and replug."
      ],
      "provenance": {
        "author": "Steven Zimmerman",
        "date": "2026-02-07"
      }
    }
  ]
}
